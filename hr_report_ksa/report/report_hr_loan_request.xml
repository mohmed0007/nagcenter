<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_payslip_run_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                        <div class="page" dir="rtl">
                            <div class="text-center" style="margin-top: -30px">
                                <h4 style="! important;font-weight: bold ! important;">
                                    <strong>Employee Payslips Batch</strong>
                                </h4>
                            </div>
                            <br/>

                            <div class="text-center report_table">

                                <span style="! important;font-weight: bold ! important;color:#875A7B" t-if="o.date_start">
                                    <strong class="p-4">From :
                                        <span t-esc="o.date_start"/>
                                    </strong>
                                </span>
                                <span style="! important;font-weight: bold ! important;color:#875A7B" t-if="o.date_end">
                                    <strong class="p-4">To :
                                        <span t-esc="o.date_end"/>
                                    </strong>
                                </span>
                                <div class="p-1"/>

                            </div>
                            <br/>
                            <br/>
                             <t t-if="o.company_id">
                                <div class="text-left report_table" >

                                    <span  style="text-center !important;color:#875A7B" >
                                        <strong class="p-4">Company :
                                            <span t-esc="o.company_id.name"/>
                                        </strong>
                                    </span>

                                </div>
                            </t>

                            <br/>

                            <br/>


                            <table class="table table-condensed table-bordered"
                                   style="width: 100% ! important;font-size:10px ! important;">
                                <thead>

                                    <tr>
                                        <th colspan="6"></th>
                                        <th colspan="6" scope="colgroup" class="text-center border border-dark">
                                            Allowance
                                        </th>
                                        <th colspan="3" scope="colgroup" class="text-center border border-dark">
                                            Deduction
                                        </th>
                                        <th colspan="2"></th>

                                    </tr>
                                    <tr>
                                        <th class="text-center" style="width: 5%">No</th>
                                        <th class="text-center" style="width: 7%">Employee No</th>
                                        <th class="text-center" style="width: 15%">Name</th>
                                        <th class="text-center" style="width: 7% ! important">Basic Salary</th>
                                        <th class="text-center" style="width: 7% ! important">Working Days</th>
                                        <th class="text-center" style="width: 7% ! important">Net Salary</th>
                                        <th class="text-center" style="width: 7% ! important">Housing</th>
                                        <th class="text-center" style="width: 7%">Tra Allowance</th>
                                        <th class="text-center" style="width: 7%">Subsistence</th>
                                        <th class="text-center" style="width: 7%">Fix</th>
                                        <th class="text-center" style="width: 7%">Other</th>
                                        <th class="text-center" style="width: 7%">Total</th>
                                        <th class="text-center" style="width: 7% ! important">loan</th>
                                        <th class="text-center" style="width: 7% ! important">Insurance</th>
<!--                                        <th class="text-center" style="width: 5% ! important">Other</th>-->
                                        <th class="text-center" style="width: 7% ! important">Total</th>
                                        <th class="text-center" style="width: 7% ! important">Total Salary</th>
                                        <th class="text-center" style="width: 7% ! important">signature</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-set="No" t-value="0"/>
<!--                                    <tr>-->
<!--                                        <td class="text-center">-->
<!--                                                <span t-esc="No"/>-->
<!--                                        </td>-->
<!--                                        <td class="text-center">-->
<!--                                           <span t-esc="o.slip_ids"/>-->
<!--                                        </td>-->
<!--                                    </tr>-->
                                    <t t-foreach="o.slip_ids" t-as="slip">
                                        <tr>
                                            <td class="text-center">
                                                <span t-esc="No"/>
                                            </td>
                                            <td class="text-center ">
                                                <span t-esc="slip.employee_id.employee_number"/>
                                            </td>
                                            <td class="text-center w-25">
                                                <span t-esc="slip.employee_id.name"/>
                                            </td>
<!--                                            <td class="text-center w-25">-->
<!--                                                <span t-esc="slip.employee_id.name"/>-->
<!--                                            </td>-->
                                            <t t-set="basic" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'BASIC')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="basic"/>
                                            </td>
                                            <t t-set="working_days" t-value="request.env['hr.payslip.worked_days'].sudo().search([('payslip_id', '=', slip.id)],limit = 1).number_of_days"/>
                                            <td class="text-center">
                                                <span t-esc="working_days"/>
                                            </td>
                                            <t t-set="net" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'NET')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="net"/>
                                            </td>
                                            <t t-set="Hra" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'HRA')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="Hra"/>
                                            </td>
                                            <t t-set="travel" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'Travel')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="travel"/>
                                            </td>

                                            <t t-set="DA" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'DA')],limit = 1).total"/>

                                            <td class="text-center">
                                                <span t-esc="DA"/>
                                            </td>
                                            <t t-set="fix" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'Fix')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="fix"/>
                                            </td>
                                            <t t-set="Other" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'Other')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="Other"/>
                                            </td>

                                            <td class="text-center">
                                                <span t-esc="Other + fix + DA + travel + Hra"/>
                                            </td>
                                            <t t-set="loan" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'LO')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="loan"/>
                                            </td>
                                            <t t-set="Insurance" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'Insurance')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="Insurance"/>
                                            </td>

                                            <td class="text-center">
                                                <span t-esc="Insurance + loan "/>
                                            </td>
                                            <t t-set="net" t-value="request.env['hr.payslip.line'].sudo().search([('slip_id', '=', slip.id),('code', '=', 'NET')],limit = 1).total"/>
                                            <td class="text-center">
                                                <span t-esc="net"/>
                                            </td>
                                            <td class="text-center">

                                            </td>

                                        </tr>

                                        <t t-set="No" t-value="No + 1 "/>
                                    </t>

                                </tbody>
                            </table>

                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>
